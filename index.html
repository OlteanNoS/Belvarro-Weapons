<!DOCTYPE html>
<html lang="ro">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>FiveM Craft Calculator</title>

  <!-- FontAwesome (co»ô) -->
  <link
    defer
    media="print"
    onload="this.media='all'"
    rel="stylesheet"
    href="https://site-assets.fontawesome.com/releases/v7.2.0/css/fontawesome.css"
  >

  <style>
    :root{
      --bg:#0c0f14;
      --panel:rgba(0,0,0,.78);
      --panel2:rgba(17,17,17,.92);
      --line:rgba(255,255,255,.10);
      --muted:rgba(255,255,255,.70);
      --ok:#2ecc71;
      --radius:14px;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family: Arial, system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
      color:#fff;
      background: var(--bg);
      display:flex;
      justify-content:center;
      padding:18px;
      overflow-x:hidden;
    }

    /* Background image (SHOP)
       IMPORTANT: linkul tƒÉu "blob:https://imgur.com/..." NU merge pe alte device-uri.
       Trebuie link DIRECT la fi»ôier (.jpg/.png/.webp) ‚Äì altfel nu se √ÆncarcƒÉ.
       P√¢nƒÉ ai link direct, las fallback gradient. */
    body::before{
      content:"";
      position:fixed; inset:0;
      background:
        linear-gradient(180deg, rgba(0,0,0,.70), rgba(0,0,0,.85)),
        /* pune aici link direct la imagine (ex: https://i.imgur.com/XXXXXXX.jpg) */
        url("");
      background-size:cover;
      background-position:center;
      filter:saturate(1.1) contrast(1.05);
      z-index:-2;
    }
    body::after{
      content:"";
      position:fixed; inset:0;
      backdrop-filter: blur(6px);
      z-index:-1;
    }

    .container{
      width:min(1050px, 100%);
      background: var(--panel);
      border:1px solid var(--line);
      border-radius: var(--radius);
      padding:22px;
      box-shadow: 0 18px 60px rgba(0,0,0,.55);
    }

    h3{margin:8px 0 12px 0}
    h4{margin:14px 0 10px 0; color:rgba(255,255,255,.90)}
    .hint{color:var(--muted); font-size:12px; margin-top:4px}

    .field{
      display:flex;
      align-items:center;
      gap:14px;
      margin:10px 0;
      min-width:0;
      flex-wrap:wrap;
    }
    .field label{
      width:210px;
      min-width:160px;
      color:var(--muted);
    }
    .field .control{
      flex:1 1 340px;
      min-width:220px;
      display:flex;
      gap:10px;
      align-items:center;
    }

    select,input{
      width:100%;
      padding:10px 10px;
      border-radius:10px;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(0,0,0,.35);
      color:#fff;
      outline:none;
    }
    select:focus,input:focus{border-color:rgba(46,204,113,.7)}
    button{
      cursor:pointer;
      border:none;
      border-radius:12px;
      padding:10px 12px;
      font-weight:800;
      color:#fff;
      background: var(--ok);
      transition: transform .08s ease, filter .2s ease, background .2s ease;
      user-select:none;
      -webkit-tap-highlight-color: transparent;
    }
    button:active{transform:scale(.98)}
    button:hover{filter:brightness(.95)}
    button.secondary{
      background: rgba(255,255,255,.10);
      border:1px solid rgba(255,255,255,.14);
      font-weight:700;
    }

    /* Progressive sections */
    section{
      overflow:hidden;
      max-height:0;
      opacity:0;
      transform: translateY(-6px);
      transition: max-height .45s ease, opacity .25s ease, transform .25s ease;
    }
    section.show{
      max-height: 1200px;
      opacity:1;
      transform: translateY(0);
    }

    /* Attachments list animation */
    .attachLine{
      display:flex;
      align-items:center;
      gap:10px;
      padding:8px 10px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(0,0,0,.25);
      border-radius:12px;
      margin:8px 0;
      opacity:0;
      transform: translateX(-14px);
      transition: opacity .25s ease, transform .25s ease, border-color .2s ease;
    }
    .attachLine.show{opacity:1; transform: translateX(0)}
    .attachLine:hover{border-color:rgba(46,204,113,.45)}
    .attachLine input{width:18px;height:18px; accent-color: var(--ok); margin:0}
    .attachName{flex:1}
    .attachMeta{color:var(--muted); font-size:12px}

    /* Result card */
    .result{
      margin-top:16px;
      padding:14px;
      background: rgba(0,0,0,.35);
      border:1px solid rgba(255,255,255,.12);
      border-radius:14px;
      opacity:0;
      transform: translateY(-10px);
      transition: opacity .28s ease, transform .28s ease;
    }
    .result.show{opacity:1; transform: translateY(0)}
    .resultHeader{
      display:flex;
      gap:12px;
      align-items:center;
      margin-bottom:10px;
    }
    .resultWeaponImg{
      width:60px; height:60px;
      border-radius:14px;
      background: rgba(255,255,255,.06);
      border:1px solid rgba(255,255,255,.12);
      padding:6px;
      object-fit:contain;
      image-rendering:-webkit-optimize-contrast;
      transform:translateZ(0);
      backface-visibility:hidden;
    }
    .resultTitle{font-weight:900}
    .resultSub{color:var(--muted); font-size:12px}

    .cats{
      display:grid;
      grid-template-columns: 1fr;
      gap:12px;
      margin-top:12px;
    }
    .catBox{
      border:1px solid rgba(255,255,255,.10);
      background: rgba(0,0,0,.20);
      border-radius:14px;
      padding:12px;
    }
    .catTop{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      flex-wrap:wrap;
      margin-bottom:10px;
    }
    .catName{font-weight:900}
    .catTotal{color:rgba(255,255,255,.85); font-weight:800}

    .matGrid{
      display:grid;
      grid-template-columns: 1fr;
      gap:8px;
    }
    .matCard{
      display:flex;
      align-items:center;
      gap:12px;
      padding:10px;
      border-radius:12px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(0,0,0,.22);
      max-width:100%;
      min-width:0;
      flex-wrap:wrap; /* FIX mobil */
    }
    .matIcon{
      width:34px;height:34px;
      border-radius:10px;
      border:1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.06);
      padding:5px;
      object-fit:contain;
      flex:0 0 auto;
      image-rendering:-webkit-optimize-contrast;
      transform:translateZ(0);
      backface-visibility:hidden;
    }
    .matLeft{flex:1 1 auto; min-width:0}
    .matName{font-weight:900}
    .matDesc{color:var(--muted); font-size:12px}
    .matQty{
      display:flex;
      align-items:center;
      gap:10px;
      margin-left:auto;
      flex:0 0 auto;
    }
    .matQty input[type="number"]{
      width:120px;
      max-width:100%;
      min-width:90px;
      padding:8px 10px;
    }
    @media (max-width:520px){
      .matQty{width:100%}
      .matQty input[type="number"]{width:100%; min-width:0}
    }

    .totalRow{
      margin-top:12px;
      padding-top:12px;
      border-top:1px solid rgba(255,255,255,.12);
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:10px;
      flex-wrap:wrap;
    }
    .money{font-weight:900}

    /* Popup */
    .popup{
      position:fixed; inset:0;
      display:flex;
      justify-content:center;
      align-items:center;
      background: rgba(0,0,0,.72);
      opacity:0;
      pointer-events:none;
      transition: opacity .2s ease;
      padding:18px;
    }
    .popup.show{opacity:1; pointer-events:auto}
    .popupContent{
      width:min(520px, 100%);
      background: rgba(0,0,0,.85);
      border:1px solid rgba(255,255,255,.14);
      border-radius:16px;
      padding:16px;
    }
    .popupContent p{margin:0 0 10px 0; color:var(--muted)}

    /* Weapons modal */
    .modal{
      position:fixed; inset:0;
      background: rgba(0,0,0,.78);
      opacity:0;
      pointer-events:none;
      transition: opacity .2s ease;
      padding:18px;
      display:flex;
      justify-content:center;
      align-items:flex-start;
      overflow:auto;
    }
    .modal.show{opacity:1; pointer-events:auto}
    .modalBox{
      width:min(1050px, 100%);
      background: rgba(0,0,0,.86);
      border:1px solid rgba(255,255,255,.14);
      border-radius:16px;
      padding:14px;
      margin-top:22px;
      box-shadow: 0 18px 60px rgba(0,0,0,.55);
    }
    .modalTop{
      display:flex;
      gap:10px;
      align-items:center;
      justify-content:space-between;
      flex-wrap:wrap;
      margin-bottom:12px;
    }
    .modalTitle{font-weight:900}
    .weaponGrid{
      display:grid;
      grid-template-columns: repeat(4, 1fr);
      gap:12px;
    }
    @media (max-width:980px){ .weaponGrid{grid-template-columns: repeat(3, 1fr);} }
    @media (max-width:720px){ .weaponGrid{grid-template-columns: repeat(2, 1fr);} }
    @media (max-width:420px){ .weaponGrid{grid-template-columns: 1fr;} }

    .wCard{
      border:1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.04);
      border-radius:16px;
      padding:12px;
      cursor:pointer;
      transition: transform .08s ease, border-color .2s ease, background .2s ease;
      user-select:none;
      -webkit-tap-highlight-color: transparent;
    }
    .wCard:hover{
      border-color: rgba(46,204,113,.5);
      background: rgba(46,204,113,.06);
    }
    .wCard:active{transform:scale(.99)}
    .wImgWrap{position:relative}
    .wImg{
      width:100%;
      height:110px;
      object-fit:contain;
      background: rgba(0,0,0,.30);
      border-radius:14px;
      border:1px solid rgba(255,255,255,.10);
      padding:10px;
      image-rendering: -webkit-optimize-contrast;
      transform: translateZ(0);
      backface-visibility: hidden;
    }
    .wZoomBtn{
      position:absolute;
      right:8px;
      top:8px;
      width:34px;
      height:34px;
      border-radius:10px;
      border:1px solid rgba(255,255,255,0.12);
      background: rgba(0,0,0,0.55);
      color:#fff;
      font-weight:900;
      cursor:pointer;
      display:flex;
      align-items:center;
      justify-content:center;
      backdrop-filter: blur(6px);
    }
    .wZoomBtn:hover{
      background: rgba(0,0,0,0.75);
      border-color: rgba(46,204,113,.55);
    }
    .wInfo{margin-top:10px}
    .wName{font-weight:900}
    .wMetaRow{display:flex; gap:8px; margin-top:6px; flex-wrap:wrap}
    .tag{
      font-size:12px;
      color: rgba(255,255,255,.85);
      border:1px solid rgba(255,255,255,.14);
      background: rgba(0,0,0,.25);
      padding:4px 8px;
      border-radius:999px;
    }

    /* Lightbox for images */
    .lightbox{
      position:fixed; inset:0;
      background: rgba(0,0,0,.82);
      opacity:0;
      pointer-events:none;
      transition: opacity .2s ease;
      display:flex;
      justify-content:center;
      align-items:center;
      padding:18px;
    }
    .lightbox.show{opacity:1; pointer-events:auto}
    .lbBox{
      width:min(960px, 100%);
      background: rgba(0,0,0,.85);
      border:1px solid rgba(255,255,255,.14);
      border-radius:16px;
      padding:12px;
    }
    .lbTop{
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:10px;
      flex-wrap:wrap;
      margin-bottom:10px;
    }
    .lbTitle{font-weight:900}
    .lbImg{
      width:100%;
      height:min(70vh, 560px);
      object-fit:contain;
      background: rgba(255,255,255,.04);
      border:1px solid rgba(255,255,255,.10);
      border-radius:14px;
      padding:10px;
      image-rendering: -webkit-optimize-contrast;
      transform: translateZ(0);
      backface-visibility: hidden;
    }
  </style>
</head>

<body>
  <div class="container">
    <h3>Ce vrei sƒÉ craftezi?</h3>

    <!-- Step 1 -->
    <div class="field">
      <label>Arma:</label>
      <div class="control">
        <button id="openWeapons" class="secondary" type="button" style="flex:1;">
          SelecteazƒÉ arma
        </button>
      </div>
    </div>
    <div class="hint" id="selectedWeaponHint"></div>

    <!-- Step 2 -->
    <section id="bulletsSection">
      <div class="field">
        <label for="bullets">Gloan»õe:</label>
        <div class="control">
          <select id="bullets"></select>
        </div>
      </div>
      <div class="hint" id="bulletsHint"></div>
    </section>

    <!-- Step 3 -->
    <section id="attachmentsSection">
      <h3>Ata»ôamente</h3>
      <div class="field" style="margin-top:0;">
        <label style="width:auto;min-width:0;">
          <input type="checkbox" id="noAttach" style="width:18px;height:18px;accent-color:var(--ok);vertical-align:middle;margin-right:8px;">
          Nu vreau ata»ôamente
        </label>
      </div>
      <div id="attachmentList"></div>
    </section>

    <!-- Step 4 -->
    <section id="quantitySection">
      <div class="field">
        <label for="weaponQty">NumƒÉr arme:</label>
        <div class="control">
          <input type="number" id="weaponQty" min="1" value="1">
        </div>
      </div>
    </section>

    <button id="calcBtn" style="display:none;">CalculeazƒÉ</button>

    <div id="result" class="result"></div>
  </div>

  <!-- Popup -->
  <div class="popup" id="popup">
    <div class="popupContent">
      <p id="popupText"></p>
      <button type="button" onclick="document.getElementById('popup').classList.remove('show')">OK</button>
    </div>
  </div>

  <!-- Weapons Modal -->
  <div class="modal" id="weaponsModal" aria-hidden="true">
    <div class="modalBox">
      <div class="modalTop">
        <div class="modalTitle">Alege o armƒÉ</div>
        <div style="display:flex; gap:10px; align-items:center; flex-wrap:wrap;">
          <button class="secondary" type="button" id="closeWeapons">√énchide</button>
        </div>
      </div>
      <div class="weaponGrid" id="weaponGrid"></div>
    </div>
  </div>

  <!-- Lightbox -->
  <div class="lightbox" id="lightbox">
    <div class="lbBox">
      <div class="lbTop">
        <div class="lbTitle" id="lbTitle">Preview</div>
        <button class="secondary" type="button" id="lbClose">√énchide</button>
      </div>
      <img id="lbImg" class="lbImg" alt="">
    </div>
  </div>

<script>
  // ===========================
  // Imagini materiale
  // ===========================
  const MATERIAL_IMAGES = {
    steel: "https://assetsfivem.fplayt.ro/images/gui/images/items/steel.webp",
    screw: "https://assetsfivem.fplayt.ro/images/gui/images/items/bolts.webp",
    barrel: "https://assetsfivem.fplayt.ro/images/gui/images/items/barrel.webp",
    spring: "https://assetsfivem.fplayt.ro/images/gui/images/items/arcmetalic.webp",
    wood: "https://assetsfivem.fplayt.ro/images/gui/images/items/wood.webp",
    polymer: "https://assetsfivem.fplayt.ro/images/gui/images/items/polimer.webp",
    bec: "https://assetsfivem.fplayt.ro/images/gui/images/items/bec.webp",
    lupa: "https://assetsfivem.fplayt.ro/images/gui/images/items/lupa.webp",
    powder: "https://assetsfivem.fplayt.ro/images/gui/images/items/copper.webp",
  };

  const MATERIAL_LABELS = {
    steel: "O»õel",
    screw: "»òuruburi",
    barrel: "»öeavƒÉ",
    spring: "Arc",
    wood: "Lemn",
    polymer: "Polimer",
    bec: "Bec",
    lupa: "LupƒÉ",
    powder: "Praf de pu»ôcƒÉ",
  };

  // ===========================
  // Imagini arme (din lista ta)
  // ===========================
  const WEAPON_IMAGES = {
    "PISTOL":"http://assetsarena.fplayt.ro/images/weapons/Pistol.webp",
    "COMBAT PISTOL":"http://assetsarena.fplayt.ro/images/weapons/Combat_Pistol.webp",
    "PISTOL MK2":"http://assetsarena.fplayt.ro/images/weapons/Pistol_Mk_II.webp",
    "CERAMIC PISTOL":"http://assetsarena.fplayt.ro/images/weapons/Ceramic_Pistol.webp",
    "PISTOL WM29 (XM3)":"http://assetsarena.fplayt.ro/images/weapons/Pistol_XM3.webp",
    "MICRO SMG":"http://assetsarena.fplayt.ro/images/weapons/Micro_SMG.webp",
    "MACHINE PISTOL (Tec9)":"http://assetsarena.fplayt.ro/images/weapons/Machine_Pistol.webp",
    "MINI SMG":"http://assetsarena.fplayt.ro/images/weapons/Mini_SMG.webp",
    "TEC PISTOL (Tactical SMG)":"http://assetsarena.fplayt.ro/images/weapons/TEC_Pistol.webp",
    "SMG":"http://assetsarena.fplayt.ro/images/weapons/SMG.webp",
    "COMBAT PDW":"http://assetsarena.fplayt.ro/images/weapons/Combat_PDW.webp",
    "ASSAULT RIFLE (AK)":"http://assetsarena.fplayt.ro/images/weapons/Assault_Rifle.webp",
    "COMPACT RIFLE":"http://assetsarena.fplayt.ro/images/weapons/Compact_Rifle.webp",
    "CARABINE RIFLE":"http://assetsarena.fplayt.ro/images/weapons/Carbine_Rifle.webp",
    "ADVANCED RIFLE":"http://assetsarena.fplayt.ro/images/weapons/Advanced_Rifle.webp",

    "VINTIGE PISTOL":"http://assetsarena.fplayt.ro/images/weapons/Vintage_Pistol.webp",
    "DB":"http://assetsarena.fplayt.ro/images/weapons/Double_Action_Revolver.webp",
    "Navy Pistol":"http://assetsarena.fplayt.ro/images/weapons/Navy_Revolver.webp",
    "ASSAULTRIFE MK2 (AK)":"http://assetsarena.fplayt.ro/images/weapons/Assault_Rifle_Mk_II.webp",
    "HEAVYRIFLE":"http://assetsarena.fplayt.ro/images/weapons/Heavy_Rifle.webp",
    "COMBAT MG MK2":"http://assetsarena.fplayt.ro/images/weapons/Combat_MG_Mk_II.webp",
    "GUSENBERG":"http://assetsarena.fplayt.ro/images/weapons/Gusenberg_Sweeper.webp",
    "MG":"http://assetsarena.fplayt.ro/images/weapons/MG.webp",
  };

  // ===========================
  // Helpers
  // ===========================
  function showPopup(msg){
    document.getElementById("popupText").innerText = msg;
    document.getElementById("popup").classList.add("show");
  }
  function showSection(el){ el.classList.add("show"); }
  function hideSection(el){ el.classList.remove("show"); }
  function fmt(n){ return (Number(n)||0).toLocaleString("ro-RO"); }
  function attachment(name, data){ return { name, data }; }

  // ===========================
  // BULLETS: exact la 100/200/250 + interpolare p√¢nƒÉ la 2000
  // ===========================
  function bulletProfile(p100, c100, p200, c200, p250, c250){
    return { 100:{powder:p100,price:c100}, 200:{powder:p200,price:c200}, 250:{powder:p250,price:c250} };
  }
  function lerp(a,b,t){ return a + (b-a)*t; }

  function interpBullet(profile, bullets){
    if(profile[bullets]) return { powder: profile[bullets].powder, price: profile[bullets].price };

    if(bullets < 100){
      const t = (bullets-100)/(200-100);
      return {
        powder: Math.round(lerp(profile[100].powder, profile[200].powder, t)),
        price: Math.round(lerp(profile[100].price, profile[200].price, t)),
      };
    }

    if(bullets > 250){
      const slopePow = (profile[250].powder - profile[200].powder) / 50;
      const slopePrice = (profile[250].price - profile[200].price) / 50;
      const d = bullets - 250;
      return {
        powder: Math.round(profile[250].powder + slopePow*d),
        price: Math.round(profile[250].price + slopePrice*d),
      };
    }

    if(bullets > 100 && bullets < 200){
      const t = (bullets-100)/100;
      return {
        powder: Math.round(lerp(profile[100].powder, profile[200].powder, t)),
        price: Math.round(lerp(profile[100].price, profile[200].price, t)),
      };
    } else {
      const t = (bullets-200)/50;
      return {
        powder: Math.round(lerp(profile[200].powder, profile[250].powder, t)),
        price: Math.round(lerp(profile[200].price, profile[250].price, t)),
      };
    }
  }

  const BULLET_CHOICES = (()=>{
    const arr = [100,200,250];
    for(let b=300;b<=2000;b+=100) arr.push(b);
    return arr;
  })();

  // ===========================
  // ARME + ATA»òAMENTE (√Æn ordinea ta)
  // ===========================
  const weapons = [
    // CRAFT
    { name:"PISTOL", type:"craft",
      materials:{steel:8,screw:80,barrel:0,spring:1,wood:0,polymer:20},
      bullets: bulletProfile(100,5400, 200,10666, 250,13333),
      attachments:[
        attachment("LanternƒÉ",{steel:1,screw:5,polymer:1,bec:1,lupa:1}),
        attachment("Amortizor",{steel:2,screw:5,polymer:2}),
        attachment("√éncƒÉrcƒÉtor",{steel:1,screw:5,spring:1,polymer:1})
      ]
    },
    { name:"COMBAT PISTOL", type:"craft",
      materials:{steel:8,screw:85,barrel:0,spring:0,wood:0,polymer:18},
      bullets: bulletProfile(100,5400, 200,10700, 250,13400),
      attachments:[
        attachment("LanternƒÉ",{steel:1,screw:5,polymer:1,bec:1,lupa:1}),
        attachment("Amortizor",{steel:2,screw:5,polymer:2}),
        attachment("√éncƒÉrcƒÉtor",{steel:1,screw:5,spring:1,polymer:1})
      ]
    },
    { name:"PISTOL MK2", type:"craft",
      materials:{steel:9,screw:91,barrel:0,spring:1,wood:0,polymer:22},
      bullets: bulletProfile(130,7000, 260,13900, 325,17400),
      attachments:[
        attachment("√éncƒÉrcƒÉtor",{steel:1,screw:5,spring:1,polymer:1}),
        attachment("Mounted-Scope",{steel:2,screw:10,polymer:2,lupa:1}),
        attachment("Amortizor",{steel:2,screw:5,polymer:2}),
        attachment("LanternƒÉ",{steel:1,screw:5,polymer:1,bec:1,lupa:1})
      ]
    },
    { name:"CERAMIC PISTOL", type:"craft",
      materials:{steel:9,screw:91,barrel:0,spring:1,wood:0,polymer:18},
      bullets: bulletProfile(130,7000, 260,13900, 325,17400),
      attachments:[
        attachment("Amortizor",{steel:2,screw:5,polymer:2}),
        attachment("√éncƒÉrcƒÉtor",{steel:1,screw:5,spring:1,polymer:1})
      ]
    },
    { name:"PISTOL WM29 (XM3)", type:"craft",
      materials:{steel:10,screw:95,barrel:0,spring:1,wood:0,polymer:20},
      bullets: bulletProfile(130,7000, 260,13900, 325,17400),
      attachments:[
        attachment("Amortizor",{steel:2,screw:5,polymer:2})
      ]
    },

    { name:"MICRO SMG", type:"craft",
      materials:{steel:15,screw:95,barrel:1,spring:1,wood:0,polymer:42},
      bullets: bulletProfile(150,8000, 300,16000, 375,20000),
      attachments:[
        attachment("LunetƒÉ",{steel:2,screw:10,polymer:2,lupa:1}),
        attachment("LanternƒÉ",{steel:1,screw:5,polymer:1,bec:1,lupa:1}),
        attachment("Amortizor",{steel:3,screw:5,polymer:3}),
        attachment("√éncƒÉrcƒÉtor",{steel:2,screw:10,spring:1,polymer:2})
      ]
    },
    { name:"MACHINE PISTOL (Tec9)", type:"craft",
      materials:{steel:12,screw:100,barrel:0,spring:1,wood:0,polymer:38},
      bullets: bulletProfile(150,8000, 300,16000, 375,20000),
      attachments:[
        attachment("Amortizor",{steel:2,screw:5,polymer:2}),
        attachment("√éncƒÉrcƒÉtor",{steel:2,screw:8,spring:1,polymer:2})
      ]
    },
    { name:"MINI SMG", type:"craft",
      materials:{steel:11,screw:97,barrel:0,spring:1,wood:1,polymer:36},
      bullets: bulletProfile(150,8000, 300,16000, 375,20000),
      attachments:[
        attachment("√éncƒÉrcƒÉtor",{steel:2,screw:10,spring:1,polymer:2})
      ]
    },
    { name:"TEC PISTOL (Tactical SMG)", type:"craft",
      materials:{steel:14,screw:115,barrel:1,spring:1,wood:0,polymer:44},
      bullets: bulletProfile(180,10000, 360,19000, 450,24000),
      attachments:[
        attachment("LunetƒÉ",{steel:2,screw:10,polymer:2,lupa:1}),
        attachment("√éncƒÉrcƒÉtor",{steel:2,screw:10,spring:1,polymer:2}),
        attachment("Suppresor-Muzzle-Brake",{steel:3,screw:5,polymer:3})
      ]
    },
    { name:"SMG", type:"craft",
      materials:{steel:13,screw:105,barrel:1,spring:1,wood:0,polymer:48},
      bullets: bulletProfile(180,10000, 360,19000, 450,24000),
      attachments:[
        attachment("√éncƒÉrcƒÉtor",{steel:2,screw:10,spring:1,polymer:2}),
        attachment("Baterie-Gloante",{steel:3,screw:20,spring:1,polymer:3}),
        attachment("LanternƒÉ",{steel:1,screw:5,polymer:1,bec:1,lupa:1}),
        attachment("Amortizor",{steel:3,screw:5,polymer:3}),
        attachment("LunetƒÉ",{steel:2,screw:10,polymer:2,lupa:1})
      ]
    },
    { name:"COMBAT PDW", type:"craft",
      materials:{steel:14,screw:110,barrel:1,spring:1,wood:0,polymer:50},
      bullets: bulletProfile(180,10000, 360,19000, 450,24000),
      attachments:[
        attachment("LanternƒÉ",{steel:1,screw:5,polymer:1,bec:1,lupa:1}),
        attachment("Baterie-Gloante",{steel:3,screw:20,spring:1,polymer:3}),
        attachment("LunetƒÉ",{steel:2,screw:10,polymer:2,lupa:1}),
        attachment("√éncƒÉrcƒÉtor",{steel:2,screw:10,spring:1,polymer:2}),
        attachment("Grip",{steel:1,screw:5,polymer:1})
      ]
    },

    { name:"ASSAULT RIFLE (AK)", type:"craft",
      materials:{steel:21,screw:135,barrel:1,spring:2,wood:1,polymer:68},
      bullets: bulletProfile(250,13400, 500,26700, 625,33400),
      attachments:[
        attachment("LunetƒÉ",{steel:2,screw:10,polymer:2,lupa:1}),
        attachment("Baterie-Gloante",{steel:3,screw:20,spring:1,polymer:3}),
        attachment("Amortizor",{steel:3,screw:5,polymer:3}),
        attachment("√éncƒÉrcƒÉtor",{steel:2,screw:5,spring:1,polymer:2}),
        attachment("Grip",{steel:1,screw:5,polymer:1}),
        attachment("LanternƒÉ",{steel:1,screw:5,polymer:1,bec:1,lupa:1})
      ]
    },
    { name:"COMPACT RIFLE", type:"craft",
      materials:{steel:19,screw:115,barrel:1,spring:2,wood:1,polymer:44},
      bullets: bulletProfile(250,13400, 500,26700, 625,33400),
      attachments:[
        attachment("√éncƒÉrcƒÉtor",{steel:3,screw:30,spring:1,polymer:3}),
        attachment("Baterie-Gloante",{steel:3,screw:20,spring:1,polymer:3})
      ]
    },
    { name:"CARABINE RIFLE", type:"craft",
      materials:{steel:18,screw:140,barrel:1,spring:2,wood:0,polymer:72},
      bullets: bulletProfile(300,16000, 600,32000, 750,40000),
      attachments:[
        attachment("Grip",{steel:1,screw:5,polymer:1}),
        attachment("√éncƒÉrcƒÉtor",{steel:1,screw:5,spring:1,polymer:1}),
        attachment("LunetƒÉ",{steel:2,screw:10,polymer:2,lupa:1}),
        attachment("Baterie-Gloante",{steel:3,screw:20,spring:1,polymer:3}),
        attachment("Amortizor",{steel:3,screw:5,polymer:3}),
        attachment("LanternƒÉ",{steel:1,screw:5,polymer:1,bec:1,lupa:1})
      ]
    },
    { name:"ADVANCED RIFLE", type:"craft",
      materials:{steel:18,screw:145,barrel:1,spring:2,wood:0,polymer:78},
      bullets: bulletProfile(300,16000, 600,32000, 750,40000),
      attachments:[
        attachment("LanternƒÉ",{steel:1,screw:5,polymer:1,bec:1,lupa:1}),
        attachment("Amortizor",{steel:3,screw:5,polymer:3}),
        attachment("√éncƒÉrcƒÉtor",{steel:1,screw:5,spring:1,polymer:1}),
        attachment("LunetƒÉ",{steel:2,screw:10,polymer:2,lupa:1})
      ]
    },

    // OFICIALA (pe bani)
    { name:"Navy Pistol", type:"money", price:400000,
      bullets: bulletProfile(500,26700, 1000,54000, 1250,66700),
      attachments:[]
    },
    { name:"VINTIGE PISTOL", type:"money", price:25000,
      bullets: bulletProfile(150,8000, 300,16000, 375,20000),
      attachments:[
        attachment("√éncƒÉrcƒÉtor",{steel:1,screw:5,spring:1,polymer:1}),
        attachment("Amortizor",{steel:2,screw:5,polymer:2})
      ]
    },
    { name:"DB", type:"money", price:250000,
      bullets: bulletProfile(500,26700, 1000,54000, 1250,66700),
      attachments:[]
    },
    { name:"ASSAULTRIFE MK2 (AK)", type:"money", price:70000,
      bullets: bulletProfile(300,16000, 600,32000, 750,40000),
      attachments:[
        attachment("LunetƒÉ-Mica",{steel:2,screw:10,polymer:2,lupa:1}),
        attachment("LanternƒÉ",{steel:1,screw:5,polymer:1,bec:1,lupa:1}),
        attachment("√éncƒÉrcƒÉtor",{steel:2,screw:5,spring:1,polymer:2}),
        attachment("LunetƒÉ-Mare",{steel:2,screw:12,polymer:2,lupa:1}),
        attachment("Grip",{steel:1,screw:5,polymer:1}),
        attachment("»öeavƒÉ",{barrel:4,screw:16,polymer:4}),
        attachment("Heavy Dutty Muzzle Brake",{steel:1,screw:4,polymer:1}),
        attachment("Vizor-Holografic",{steel:1,screw:8,polymer:1,lupa:1}),
        attachment("Flat-Muzzle-Brake",{steel:1,screw:4,polymer:1}),
        attachment("Slanded-Muzzle-Brake",{steel:1,screw:4,polymer:1}),
        attachment("Amortizor",{steel:3,screw:5,polymer:3}),
        attachment("Tactical-Muzzle-Brake",{steel:1,screw:4,polymer:1}),
        attachment("Precision-Muzzle-Brake",{steel:1,screw:4,polymer:1}),
        attachment("Split-End-Muzzle-Brake",{steel:1,screw:4,polymer:1}),
        attachment("Fat-End-Muzzle-Brake",{steel:1,screw:4,polymer:1})
      ]
    },
    { name:"HEAVYRIFLE", type:"money", price:60000,
      bullets: bulletProfile(300,16000, 600,32000, 750,40000),
      attachments:[
        attachment("LanternƒÉ",{steel:1,screw:5,polymer:1,bec:1,lupa:1}),
        attachment("√éncƒÉrcƒÉtor",{steel:1,screw:5,spring:1,polymer:1}),
        attachment("LunetƒÉ",{steel:2,screw:10,polymer:2,lupa:1}),
        attachment("Amortizor",{steel:3,screw:5,polymer:3}),
        attachment("Grip",{steel:1,screw:5,polymer:1})
      ]
    },
    { name:"COMBAT MG MK2", type:"money", price:120000,
      bullets: bulletProfile(300,16000, 600,32000, 750,40000),
      attachments:[]
    },
    { name:"GUSENBERG", type:"money", price:45000,
      bullets: bulletProfile(180,9600, 360,19000, 450,24000),
      attachments:[]
    },
    { name:"MG", type:"money", price:90000,
      bullets: bulletProfile(300,16000, 600,32000, 750,40000),
      attachments:[]
    },
  ];

  // ===========================
  // UI state
  // ===========================
  const bulletsSection = document.getElementById("bulletsSection");
  const attachmentsSection = document.getElementById("attachmentsSection");
  const quantitySection = document.getElementById("quantitySection");
  const bulletsSelect = document.getElementById("bullets");
  const bulletsHint = document.getElementById("bulletsHint");
  const attachmentList = document.getElementById("attachmentList");
  const noAttach = document.getElementById("noAttach");
  const weaponQty = document.getElementById("weaponQty");
  const calcBtn = document.getElementById("calcBtn");
  const resultDiv = document.getElementById("result");
  const openWeaponsBtn = document.getElementById("openWeapons");
  const selectedWeaponHint = document.getElementById("selectedWeaponHint");

  const weaponsModal = document.getElementById("weaponsModal");
  const weaponGrid = document.getElementById("weaponGrid");
  const closeWeaponsBtn = document.getElementById("closeWeapons");

  const lightbox = document.getElementById("lightbox");
  const lbImg = document.getElementById("lbImg");
  const lbTitle = document.getElementById("lbTitle");
  const lbClose = document.getElementById("lbClose");

  let selectedWeaponIndex = -1;

  function resetFlow(){
    hideSection(bulletsSection);
    hideSection(attachmentsSection);
    hideSection(quantitySection);
    bulletsSelect.innerHTML = "";
    attachmentList.innerHTML = "";
    noAttach.checked = false;
    calcBtn.style.display = "none";
    resultDiv.classList.remove("show");
    resultDiv.innerHTML = "";
    bulletsHint.textContent = "";
  }

  function openModal(){ weaponsModal.classList.add("show"); }
  function closeModal(){ weaponsModal.classList.remove("show"); }

  function openLightbox(title, src){
    lbTitle.textContent = title;
    lbImg.src = src;
    lbImg.alt = title;
    lightbox.classList.add("show");
  }
  function closeLightbox(){
    lightbox.classList.remove("show");
    lbImg.src = "";
  }

  lbClose.addEventListener("click", closeLightbox);
  lightbox.addEventListener("click",(e)=>{ if(e.target===lightbox) closeLightbox(); });

  openWeaponsBtn.addEventListener("click", openModal);
  closeWeaponsBtn.addEventListener("click", closeModal);
  weaponsModal.addEventListener("click",(e)=>{ if(e.target===weaponsModal) closeModal(); });

  // ===========================
  // Render weapons grid
  // ===========================
  function renderWeaponGrid(){
    weaponGrid.innerHTML = "";
    weapons.forEach((w, idx)=>{
      const card = document.createElement("div");
      card.className = "wCard";
      const img = WEAPON_IMAGES[w.name] || "";
      const cat = (w.type==="craft") ? "Craft" : "OFICIALA";

      card.innerHTML = `
        <div class="wImgWrap">
          <img class="wImg" src="${img}" alt="${w.name}">
          <button class="wZoomBtn" type="button" data-zoom="1" title="Zoom">üîç</button>
        </div>
        <div class="wInfo">
          <div class="wName">${w.name}</div>
          <div class="wMetaRow">
            <span class="tag">${cat}</span>
          </div>
        </div>
      `;

      card.addEventListener("click",(e)=>{
        const zoomBtn = e.target?.closest?.("button[data-zoom]");
        if(zoomBtn){
          e.stopPropagation();
          openLightbox(w.name, img);
          return;
        }
        selectWeapon(idx);
        closeModal();
      });

      weaponGrid.appendChild(card);
    });
  }
  renderWeaponGrid();

  // ===========================
  // Select weapon -> progressive steps
  // ===========================
  function selectWeapon(idx){
    selectedWeaponIndex = idx;
    const w = weapons[idx];
    if(!w){ return; }

    openWeaponsBtn.textContent = w.name;
    selectedWeaponHint.textContent = (w.type==="craft")
      ? "Arma selectatƒÉ pentru craft."
      : "Arma selectatƒÉ (OFICIALA).";

    // reset flow but keep selected weapon
    hideSection(bulletsSection);
    hideSection(attachmentsSection);
    hideSection(quantitySection);
    bulletsSelect.innerHTML = "";
    attachmentList.innerHTML = "";
    noAttach.checked = false;
    calcBtn.style.display = "none";
    resultDiv.classList.remove("show");
    resultDiv.innerHTML = "";
    bulletsHint.textContent = "";

    // Step 2: bullets always shown (»ôi la OFICIALA)
    BULLET_CHOICES.forEach(b=>{
      const opt = document.createElement("option");
      opt.value = String(b);
      opt.textContent = `${b}`;
      bulletsSelect.appendChild(opt);
    });

    // default select 100 AND allow calculate without changing
    bulletsSelect.value = "100";
    showSection(bulletsSection);
    bulletsSelect.dispatchEvent(new Event("change"));
  }

  // Step 3 + Step 4 after bullets change
  bulletsSelect.addEventListener("change", ()=>{
    const w = weapons[selectedWeaponIndex];
    if(!w){ return; }

    const b = Number(bulletsSelect.value || 100);
    const bb = interpBullet(w.bullets, b);
    bulletsHint.textContent = `Praf: ${fmt(bb.powder)} ‚Ä¢ Cost: ${fmt(bb.price)}$ (per armƒÉ)`;

    // attachments
    attachmentList.innerHTML = "";
    noAttach.checked = false;
    hideSection(attachmentsSection);
    hideSection(quantitySection);
    calcBtn.style.display = "none";
    resultDiv.classList.remove("show");
    resultDiv.innerHTML = "";

    const atts = Array.isArray(w.attachments) ? w.attachments : [];
    if(atts.length){
      showSection(attachmentsSection);
      let i=0;
      function addNext(){
        if(i>=atts.length) return;
        const a = atts[i];
        const line = document.createElement("label");
        line.className = "attachLine";

        const d = a.data || {};
        const metaParts = [];
        ["steel","screw","barrel","spring","wood","polymer","bec","lupa"].forEach(k=>{
          if(d[k]) metaParts.push(`${MATERIAL_LABELS[k]}:${d[k]}`);
        });
        line.innerHTML = `
          <input type="checkbox" class="attachCheck" value="${i}">
          <div class="attachName">${a.name}</div>
          <div class="attachMeta">${metaParts.join(" ‚Ä¢ ")}</div>
        `;
        attachmentList.appendChild(line);
        requestAnimationFrame(()=> line.classList.add("show"));
        i++;
        setTimeout(addNext, 90);
      }
      addNext();
    }

    showSection(quantitySection);
    calcBtn.style.display = "inline-block";
  });

  noAttach.addEventListener("change", function(){
    document.querySelectorAll(".attachCheck").forEach(c=>{
      c.checked = false;
      c.disabled = this.checked;
    });
  });

  // ===========================
  // CALCUL COSTS
  // ===========================
  const PRICES = {
    steel: 5000,
    polymer: 150,
    screwPerSteel: 20,     // 20 suruburi = 1 otel
    barrelSteelCost: 4,    // 1 teava = 4 otel
  };

  function addTotals(t, add, mult=1){
    for(const k in add){
      t[k] = (t[k]||0) + (add[k]||0)*mult;
    }
  }

  function computeCosts(totals, bulletPriceTotal, baseMoneyCost){
    let cost = 0;
    cost += (totals.steel||0) * PRICES.steel;
    cost += Math.ceil((totals.screw||0)/PRICES.screwPerSteel) * PRICES.steel;
    cost += (totals.barrel||0) * PRICES.barrelSteelCost * PRICES.steel;
    cost += (totals.polymer||0) * PRICES.polymer;
    cost += bulletPriceTotal || 0;
    cost += baseMoneyCost || 0;
    return cost;
  }

  function sumCategoryCost(catTotals){
    // calc doar pentru materiale (fƒÉrƒÉ bullet / fƒÉrƒÉ base weapon money)
    let c = 0;
    c += (catTotals.steel||0) * PRICES.steel;
    c += Math.ceil((catTotals.screw||0)/PRICES.screwPerSteel) * PRICES.steel;
    c += (catTotals.barrel||0) * PRICES.barrelSteelCost * PRICES.steel;
    c += (catTotals.polymer||0) * PRICES.polymer;
    return c;
  }

  function renderMatGrid(totals, extraDesc=""){
    const order = ["steel","screw","barrel","spring","wood","polymer","bec","lupa","powder"];
    return order
      .filter(k => (totals[k]||0) > 0)
      .map(k => {
        const img = MATERIAL_IMAGES[k] || "";
        return `
          <div class="matCard">
            <img class="matIcon" src="${img}" alt="${MATERIAL_LABELS[k]}">
            <div class="matLeft">
              <div class="matName">${MATERIAL_LABELS[k]}</div>
              <div class="matDesc">${k==="powder" ? extraDesc : ""}</div>
            </div>
            <div class="matQty">
              <strong>${fmt(totals[k])}</strong>
            </div>
          </div>
        `;
      }).join("");
  }

  calcBtn.addEventListener("click", ()=>{
    const w = weapons[selectedWeaponIndex];
    if(!w){
      showPopup("SelecteazƒÉ o armƒÉ!");
      return;
    }

    const qty = Math.max(1, Number(weaponQty.value||1));
    const bullets = Number(bulletsSelect.value||100);

    // CATEGORII (cum era √Ænainte):
    // 1) Arme (materialele armei) - doar craft
    // 2) Gloan»õe (praf + cost)
    // 3) Ata»ôamente (materiale)
    // 4) Total

    const catWeapon = {steel:0,screw:0,barrel:0,spring:0,wood:0,polymer:0,bec:0,lupa:0,powder:0};
    const catAmmo   = {steel:0,screw:0,barrel:0,spring:0,wood:0,polymer:0,bec:0,lupa:0,powder:0};
    const catAtt    = {steel:0,screw:0,barrel:0,spring:0,wood:0,polymer:0,bec:0,lupa:0,powder:0};

    // bullets always
    const bb = interpBullet(w.bullets, bullets);
    catAmmo.powder += bb.powder * qty;
    const bulletPriceTotal = bb.price * qty;

    // base weapon materials only for craft
    if(w.type==="craft" && w.materials){
      addTotals(catWeapon, w.materials, qty);
    }

    // attachments materials
    if(!noAttach.checked){
      const checks = document.querySelectorAll(".attachCheck:checked");
      checks.forEach(ch=>{
        const idx = Number(ch.value);
        const a = w.attachments?.[idx];
        if(a && a.data){
          addTotals(catAtt, a.data, qty);
        }
      });
    }

    // totals
    const totals = {steel:0,screw:0,barrel:0,spring:0,wood:0,polymer:0,bec:0,lupa:0,powder:0};
    addTotals(totals, catWeapon, 1);
    addTotals(totals, catAmmo, 1);
    addTotals(totals, catAtt, 1);

    // base money cost (weapon itself)
    const baseMoneyCost = (w.type==="money" ? (w.price||0)*qty : 0);

    const totalCost = computeCosts(totals, bulletPriceTotal, baseMoneyCost);

    // header
    const weaponImg = WEAPON_IMAGES[w.name] || "";
    const typeLabel = (w.type==="craft") ? "Craft" : "OFICIALA";

    // category HTML
    const weaponGridHtml = renderMatGrid(catWeapon);
    const ammoGridHtml = renderMatGrid(catAmmo, `pentru ${bullets} gl. x ${qty}`);
    const attGridHtml = renderMatGrid(catAtt);

    const weaponMatCost = sumCategoryCost(catWeapon);
    const ammoMatCost = sumCategoryCost(catAmmo); // doar materiale (praf nu are material cost aici) -> costul prafului e √Æn bulletPriceTotal
    const attMatCost = sumCategoryCost(catAtt);

    const ammoCostShown = bulletPriceTotal; // cost exact/interpolat din tabel

    // Note: ‚ÄúcatAmmo‚Äù are doar powder ca material, dar costul e bulletPriceTotal.
    // DacƒÉ vrei »ôi ‚Äúpraf x 150$‚Äù √Æn loc de tabel, √Æl schimbƒÉm, dar acum rƒÉm√¢ne ca √Æn tabel.

    const catsHtml = `
      <div class="cats">
        ${w.type==="craft" ? `
        <div class="catBox">
          <div class="catTop">
            <div class="catName">Arma</div>
            <div class="catTotal">${fmt(weaponMatCost)}$</div>
          </div>
          <div class="matGrid">
            ${weaponGridHtml || `<div class="hint">Nu are materiale pentru armƒÉ.</div>`}
          </div>
        </div>` : ""}

        <div class="catBox">
          <div class="catTop">
            <div class="catName">Gloan»õe</div>
            <div class="catTotal">${fmt(ammoCostShown)}$</div>
          </div>
          <div class="matGrid">
            ${ammoGridHtml || `<div class="hint">Nu are materiale pentru gloan»õe.</div>`}
          </div>
        </div>

        <div class="catBox">
          <div class="catTop">
            <div class="catName">Ata»ôamente</div>
            <div class="catTotal">${fmt(attMatCost)}$</div>
          </div>
          <div class="matGrid">
            ${attGridHtml || `<div class="hint">Nu ai selectat ata»ôamente.</div>`}
          </div>
        </div>

        ${w.type==="money" ? `
        <div class="catBox">
          <div class="catTop">
            <div class="catName">Pre»õ armƒÉ (OFICIALA)</div>
            <div class="catTotal">${fmt(baseMoneyCost)}$</div>
          </div>
          <div class="hint">Costul armei (pe bani) x ${qty}.</div>
        </div>` : ""}
      </div>
    `;

    resultDiv.innerHTML = `
      <div class="resultHeader">
        <img class="resultWeaponImg" src="${weaponImg}" alt="${w.name}">
        <div>
          <div class="resultTitle">${w.name}</div>
          <div class="resultSub">${typeLabel} ‚Ä¢ ${qty} buc ‚Ä¢ ${bullets} gl.</div>
        </div>
      </div>

      ${catsHtml}

      <div class="totalRow">
        <div class="money"><i class="fa-solid fa-basket-shopping"></i> Total estimativ</div>
        <div class="money">${fmt(totalCost)}$</div>
      </div>
    `;
    resultDiv.classList.add("show");
  });

  // boot
  resetFlow();
  // render weapons grid
  (function renderWeaponGrid(){
    const weaponGrid = document.getElementById("weaponGrid");
    weaponGrid.innerHTML = "";
    weapons.forEach((w, idx)=>{
      const card = document.createElement("div");
      card.className = "wCard";
      const img = WEAPON_IMAGES[w.name] || "";
      const cat = (w.type==="craft") ? "Craft" : "OFICIALA";
      card.innerHTML = `
        <div class="wImgWrap">
          <img class="wImg" src="${img}" alt="${w.name}">
          <button class="wZoomBtn" type="button" data-zoom="1" title="Zoom">üîç</button>
        </div>
        <div class="wInfo">
          <div class="wName">${w.name}</div>
          <div class="wMetaRow">
            <span class="tag">${cat}</span>
          </div>
        </div>
      `;
      card.addEventListener("click",(e)=>{
        const zoomBtn = e.target?.closest?.("button[data-zoom]");
        if(zoomBtn){
          e.stopPropagation();
          document.getElementById("lbTitle").textContent = w.name;
          const lbImg = document.getElementById("lbImg");
          lbImg.src = img;
          lbImg.alt = w.name;
          document.getElementById("lightbox").classList.add("show");
          return;
        }
        // select
        selectedWeaponIndex = idx;
        document.getElementById("openWeapons").textContent = w.name;
        document.getElementById("selectedWeaponHint").textContent =
          (w.type==="craft") ? "Arma selectatƒÉ pentru craft." : "Arma selectatƒÉ (OFICIALA).";

        // reset flow and show bullets
        hideSection(document.getElementById("bulletsSection"));
        hideSection(document.getElementById("attachmentsSection"));
        hideSection(document.getElementById("quantitySection"));
        const bulletsSelect = document.getElementById("bullets");
        bulletsSelect.innerHTML = "";
        document.getElementById("attachmentList").innerHTML = "";
        document.getElementById("noAttach").checked = false;
        document.getElementById("calcBtn").style.display = "none";
        const resultDiv = document.getElementById("result");
        resultDiv.classList.remove("show");
        resultDiv.innerHTML = "";
        document.getElementById("bulletsHint").textContent = "";

        BULLET_CHOICES.forEach(b=>{
          const opt = document.createElement("option");
          opt.value = String(b);
          opt.textContent = `${b}`;
          bulletsSelect.appendChild(opt);
        });
        bulletsSelect.value = "100";
        showSection(document.getElementById("bulletsSection"));
        bulletsSelect.dispatchEvent(new Event("change"));

        document.getElementById("weaponsModal").classList.remove("show");
      });

      weaponGrid.appendChild(card);
    });
  })();

  // modal
  document.getElementById("openWeapons").addEventListener("click", ()=>document.getElementById("weaponsModal").classList.add("show"));
  document.getElementById("closeWeapons").addEventListener("click", ()=>document.getElementById("weaponsModal").classList.remove("show"));
  document.getElementById("weaponsModal").addEventListener("click",(e)=>{ if(e.target.id==="weaponsModal") e.target.classList.remove("show"); });

  // lightbox close
  document.getElementById("lbClose").addEventListener("click", ()=>{
    document.getElementById("lightbox").classList.remove("show");
    document.getElementById("lbImg").src = "";
  });
  document.getElementById("lightbox").addEventListener("click",(e)=>{
    if(e.target.id==="lightbox"){
      e.target.classList.remove("show");
      document.getElementById("lbImg").src = "";
    }
  });
</script>
</body>
</html>
