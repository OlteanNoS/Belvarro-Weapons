<!DOCTYPE html>
<html lang="ro">
<head>
<meta charset="UTF-8">
<title>FiveM Armes Craft Calculator Progresiv</title>
<style>
body {margin:0;font-family:Arial;background:#111;color:white;display:flex;justify-content:center;padding:20px;}
.container {background:rgba(0,0,0,0.85);padding:30px;width:1000px;border-radius:10px;}
select,input,button{width:100%;padding:8px;margin-top:10px;font-size:14px;}
button{cursor:pointer;background:#2ecc71;border:none;color:white;font-weight:bold;}
.result{margin-top:20px;padding:15px;background:#222;border-radius:8px;}
h3{margin:10px 0 5px 0;}
label{display:block;margin:5px 0;}
.popup{position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.7);display:none;justify-content:center;align-items:center;}
.popupContent{background:#222;padding:20px;border-radius:10px;color:white;}
.popupContent button{margin-top:10px;}
.attachStep{margin-top:5px;}
</style>
</head>
<body>
<div class="container">
<h3>Ce vrei să craftezi?</h3>
<select id="weaponSelect"><option value="">-- Selectează arma --</option></select>

<div id="bulletsSection" style="display:none;">
<h3>Câte gloanțe vrei?</h3>
<select id="bullets"></select>
</div>

<div id="attachmentsSection" style="display:none;">
<h3>Atașamente</h3>
<label><input type="checkbox" id="noAttach"> Nu vreau atașamente</label>
<div id="attachmentList"></div>
</div>

<div id="quantitySection" style="display:none;">
<h3>Câte arme vrei?</h3>
<input type="number" id="weaponQty" min="1" value="1">
</div>

<button id="calcBtn" style="display:none;">Calculează</button>
<div id="result" class="result" style="display:none;"></div>
</div>

<div class="popup" id="popup">
<div class="popupContent">
<p id="popupText"></p>
<button onclick="document.getElementById('popup').style.display='none'">OK</button>
</div>
</div>

<script>
// ==================== DATELE ARME ====================
const weapons={
"PISTOL":{type:"craft",materials:{steel:8,screw:80,barrel:0,spring:1,wood:0,polymer:20},bullets:{100:100,200:200,250:250},attachments:{lanterna:{steel:1,screw:5,arc:1,polymer:1,bec:1,lupa:1},amortizor:{steel:2,screw:5,polymer:2},incarcator:{steel:1,screw:5,arc:1,polymer:1}}},
"COMBAT PISTOL":{type:"craft",materials:{steel:8,screw:85,barrel:0,spring:0,wood:0,polymer:18},bullets:{100:100,200:200,250:250},attachments:{lanterna:{steel:1,screw:5,arc:1,polymer:1,bec:1,lupa:1},amortizor:{steel:2,screw:5,polymer:2},incarcator:{steel:1,screw:5,arc:1,polymer:1}}},
"PISTOL MK2":{type:"craft",materials:{steel:9,screw:91,barrel:0,spring:1,wood:0,polymer:22},bullets:{100:130,200:260,250:325},attachments:{incarcator:{steel:1,screw:5,arc:1,polymer:1},mounted_scope:{steel:2,screw:10,polymer:2,lupa:1},amortizor:{steel:2,screw:5,polymer:2},lanterna:{steel:1,screw:5,arc:1,polymer:1,bec:1,lupa:1}}},
// aici pui restul armelor craft + pe bani, exact ca în codul precedent
};

// ==================== ELEMENTE UI ====================
const weaponSelect=document.getElementById("weaponSelect");
const bulletsSection=document.getElementById("bulletsSection");
const bulletsSelect=document.getElementById("bullets");
const attachmentsSection=document.getElementById("attachmentsSection");
const attachmentList=document.getElementById("attachmentList");
const quantitySection=document.getElementById("quantitySection");
const calcBtn=document.getElementById("calcBtn");
const resultDiv=document.getElementById("result");

// Populare select arme
Object.keys(weapons).forEach(w=>{
    const opt=document.createElement("option"); opt.value=w; opt.text=w;
    weaponSelect.appendChild(opt);
});

// Pas 1: select arma
weaponSelect.addEventListener("change",()=>{
    const weapon=weapons[weaponSelect.value];
    bulletsSection.style.display="none";
    attachmentsSection.style.display="none";
    quantitySection.style.display="none";
    calcBtn.style.display="none";
    resultDiv.style.display="none";
    bulletsSelect.innerHTML="";
    attachmentList.innerHTML="";
    document.getElementById("noAttach").checked=false;

    if(!weapon) return;

    // Pas 2: gloanțe dacă arma e craft
    if(weapon.type==="craft"){
        bulletsSection.style.display="block";
        Object.keys(weapon.bullets).forEach(b=>{
            const opt=document.createElement("option"); opt.value=b; opt.text=b;
            bulletsSelect.appendChild(opt);
        });
    } else {
        // arme pe bani → nu gloanțe
        quantitySection.style.display="block";
        calcBtn.style.display="block";
    }
});

// Pas 3: atașamente
bulletsSelect.addEventListener("change",()=>{
    const weapon=weapons[weaponSelect.value];
    if(!weapon || !weapon.attachments) return;
    attachmentsSection.style.display="block";
    attachmentList.innerHTML="";

    const keys=Object.keys(weapon.attachments);
    let i=0;
    function addNextAttachment(){
        if(i>=keys.length) return;
        const att=keys[i];
        const lbl=document.createElement("label");
        lbl.className="attachStep";
        lbl.innerHTML=`<input type="checkbox" class="attachCheck" value="${att}"> ${att}`;
        attachmentList.appendChild(lbl);
        i++;
        setTimeout(addNextAttachment,100); // apare progresiv 1 câte 1
    }
    addNextAttachment();

    quantitySection.style.display="block";
    calcBtn.style.display="block";
});

// Disable atașamente dacă Nu vreau
document.getElementById("noAttach").addEventListener("change",function(){
    const checks=document.querySelectorAll(".attachCheck");
    checks.forEach(c=>{c.checked=false;c.disabled=this.checked;});
});

// ==================== CALCUL ====================
calcBtn.addEventListener("click",()=>{
    const weaponKey=weaponSelect.value;
    const weapon=weapons[weaponKey];
    const qty=parseInt(document.getElementById("weaponQty").value)||1;
    if(!weapon){document.getElementById('popupText').innerText='Selectează o armă!';document.getElementById('popup').style.display='flex'; return;}
    const totals={steel:0,screw:0,barrel:0,spring:0,wood:0,polymer:0,powder:0};

    if(weapon.type==="craft"){
        for(let k of ["steel","screw","barrel","spring","wood","polymer"])
            totals[k]+=weapon.materials[k]*qty;

        const bulletVal=parseInt(bulletsSelect.value);
        const bulletPowder=weapon.bullets[bulletVal]||Object.values(weapon.bullets)[0];
        totals.powder+=bulletPowder*qty;
    }

    document.querySelectorAll(".attachCheck:checked").forEach(att=>{
        const data=weapon.attachments[att.value];
        if(!data) return;
        for(let k of ["steel","screw","barrel","spring","wood","polymer"])
            totals[k]+=(data[k]||0)*qty;
    });

    let totalCost=0;
    if(weapon.type==="craft"){
        totalCost+=totals.steel*5000;
        totalCost+=Math.floor(totals.screw/20)*5000;
        totalCost+=totals.barrel*4*5000;
        totalCost+=totals.polymer*150;
        totalCost+=totals.powder*150;
    }else totalCost+=weapon.price*qty;

    resultDiv.style.display="block";
    resultDiv.innerHTML=`<h3>Rezultat</h3>
    Oțel: ${totals.steel}<br>
    Șurub: ${totals.screw}<br>
    Țeavă: ${totals.barrel}<br>
    Arc: ${totals.spring}<br>
    Lemn: ${totals.wood}<br>
    Polimer: ${totals.polymer}<br>
    Praf de pușcă: ${totals.powder}<br>
    <br><strong>Cost total estimativ: ${totalCost.toLocaleString()}$</strong>`;
});
</script>
</body>
</html>
